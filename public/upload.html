<!DOCTYPE html>

<html>

<head>

    <script src="js/lib/jquery-1.8.1.min.js"></script>
    <script src="js/lib/underscore.js"></script>

    <script>

        var uploader = new Worker("js/upload.worker.js");

        uploader.addEventListener("message", onUploaderMessage);
        uploader.addEventListener("error", function (e) {
            console.log(e);
        }, false);


        function uploadInputChangeHandler(e) {

            for (var i = 0; i < e.target.files.length; i++) {

                uploader.postMessage({
                    "cmd":"add",
                    "file": e.target.files[i],
                    "byteOffset":0,
                    "params":{"id":"FTW"},
                    "url":" /api/upload/"
                });

            }
        }


        function onUploaderMessage(e) {
            //console.log(event.data);
        }

        $(document).ready(function () {
            $("#uploadInput").on("change", uploadInputChangeHandler);
            $("#startBtn").on("click", function () {
                uploader.postMessage({"cmd":"start"});
            });
            $("#stopBtn").on("click", function () {
                uploader.postMessage({"cmd":"stop"});
            });
        });


    </script>

<body>


<input type="file" id="uploadInput" name="uploadInput" multiple/>
<button id="startBtn">Start</button>
<button id="stopBtn">Stop</button>


</body>
</html>